{"componentChunkName":"component---node-modules-gatsby-theme-apollo-docs-src-components-template-js","path":"/v1.5-beta/installation/requirements/","result":{"data":{"site":{"pathPrefix":"","siteMetadata":{"title":"akv2k8s docs","description":"How to get Azure Key Vault objects into Kubernetes"}},"file":{"childMarkdownRemark":{"frontmatter":{"title":"Requirements","description":"Requirements for installing akv2k8s"},"headings":[{"value":"Installation requirements"}],"fields":{"image":"social-cards/requirements.png","graphManagerUrl":""},"htmlAst":{"type":"root","children":[{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Kubernetes version >= 1.19.3"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"A dedicated kubernetes namespace (e.g. akv2k8s)"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Enabled admission controllers: MutatingAdmissionWebhook and ValidatingAdmissionWebhook"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"RBAC enabled"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Default "},{"type":"element","tagName":"a","properties":{"href":"/v1.5-beta/security/authentication/"},"children":[{"type":"text","value":"authentication"}]},{"type":"text","value":" requires Azure AKS - use "},{"type":"element","tagName":"a","properties":{"href":"/v1.5-beta/security/authentication/"},"children":[{"type":"text","value":"custom authentication"}]},{"type":"text","value":" if running outside Azure AKS."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h2","properties":{"id":"installation-requirements","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#installation-requirements","ariaLabel":"installation requirements permalink","className":["anchor","before"]},"children":[{"type":"element","tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"children":[]}]}]},{"type":"text","value":"Installation requirements"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The "},{"type":"element","tagName":"a","properties":{"href":"https://github.com/SparebankenVest/public-helm-charts/tree/master/stable/akv2k8s"},"children":[{"type":"text","value":"Akv2k8s helm chart"}]},{"type":"text","value":" lets you install:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ol","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Controller"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Env Injector\nby setting "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"controller.enabled: true"}]},{"type":"text","value":" and "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"env_injector.enabled: true"}]},{"type":"text","value":" respectively."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"blockquote","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Note"}]},{"type":"text","value":": You should at most have only one Env Injector installment in your cluster, because multiple instances of the Env Injector mutating webhook might compete and fail when a new pod (that needs environment injection) is created."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"dedicated-namespace-for-akv2k8s-env-injectors-mutating-webhook","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#dedicated-namespace-for-akv2k8s-env-injectors-mutating-webhook","ariaLabel":"dedicated namespace for akv2k8s env injectors mutating webhook permalink","className":["anchor","before"]},"children":[{"type":"element","tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"children":[]}]}]},{"type":"text","value":"Dedicated namespace for akv2k8s Env-injector's Mutating Webhook"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Akv2k8s with Env Injector enabled should be installed in a dedicated Kubernetes namespace "},{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"NOT"}]},{"type":"text","value":" label with "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"azure-key-vault-env-injection: enabled"}]},{"type":"text","value":"."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"If the namespace where the akv2k8s components is installed has the injector enabled ("},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"azure-key-vault-env-injection: enabled"}]},{"type":"text","value":"), the Env Injector will most likely not be able to start."}]},{"type":"text","value":" This is because the Env Injector mutating webhook will trigger for every pod about to start in namespaces where enabled, and in the home namepsace of the Env Injector, it will effectively point to itself, which does not exist yet."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"The simple rule to avoid any issues related to this, is to just install akv2k8s components in its own dedicated namespace."}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"h3","properties":{"id":"installation-of-multiple-controllers","style":"position:relative;"},"children":[{"type":"element","tagName":"a","properties":{"href":"#installation-of-multiple-controllers","ariaLabel":"installation of multiple controllers permalink","className":["anchor","before"]},"children":[{"type":"element","tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"children":[]}]}]},{"type":"text","value":"Installation of Multiple Controllers"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"blockquote","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"Note"}]},{"type":"text","value":": This feature is only supported for controller >= v1.3.0."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"element","tagName":"strong","properties":{},"children":[{"type":"text","value":"If you want to install multiple controllers in your cluster you need to ensure that you AT MOST have a single Env injector installment in your cluster."}]}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"There is to ways of using multiple Akv2k8s controllers inside the same cluster:"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"ol","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Isolate controller to a single namespace using the "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"watchAllNamespaces=false"}]},{"type":"text","value":" helm configuration.  (see "},{"type":"element","tagName":"a","properties":{"href":"/v1.5-beta/tutorials/sync/7-namespace-isolation-of-controller/"},"children":[{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"Sync with Namespace Isolation of Controller"}]}]},{"type":"text","value":" tutorial)."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Use the label filtered syncing feature (see "},{"type":"element","tagName":"a","properties":{"href":"/v1.5-beta/tutorials/sync/8-label-filtered-syncing/"},"children":[{"type":"element","tagName":"em","properties":{},"children":[{"type":"text","value":"Sync Objects Based on Labels"}]}]},{"type":"text","value":" tutorial)."}]},{"type":"text","value":"\n"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"The difference between the two options, is that the first lets you isolate governance of the controller to the namespace that the controller is installed in, while the second option lets you specify what "},{"type":"element","tagName":"code","properties":{"className":["language-text"]},"children":[{"type":"text","value":"AzureKeyVaultSecret"}]},{"type":"text","value":" objects the controller should handle based on labels."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"You can also use both features at the same time."}]}],"data":{"quirksMode":false}}},"childMdx":null}},"pageContext":{"id":"0f98745a-b590-57bb-b197-257e86743544","subtitle":"","versionDifference":0.10000000000000009,"versionBasePath":"/v1.5-beta","sidebarContents":[{"title":null,"pages":[{"title":"Overview","sidebarTitle":"","description":"Explore Azure Key Vault to Kubernetes","path":"/v1.5-beta/"},{"title":"Why use akv2k8s?","sidebarTitle":"","description":null,"path":"/v1.5-beta/why-akv2k8s/"},{"title":"Quick Start","sidebarTitle":"","description":"Quickly get started using Azure Key Vault to Kubernetes","path":"/v1.5-beta/quick-start/"},{"title":"How it Works","sidebarTitle":"","description":"Learn about the inner workings of akv2k8s.","path":"/v1.5-beta/how-it-works/"},{"title":"FAQ","sidebarTitle":"","description":"Most frequently asked questions","path":"/v1.5-beta/faq/"}]},{"title":"Installation","pages":[{"title":"Overview","sidebarTitle":"","description":"Different options for installing akv2k8s","path":"/v1.5-beta/installation/"},{"title":"Requirements","sidebarTitle":"","description":"Requirements for installing akv2k8s","path":"/v1.5-beta/installation/requirements/"},{"title":"Installing on Azure AKS","sidebarTitle":"","description":"How to install Azure Key Vault to Kubernetes (akv2k8s) on Azure AKS","path":"/v1.5-beta/installation/on-azure-aks/"},{"title":"Installing outside Azure AKS","sidebarTitle":"","description":"Learn how to install Azure Key Vault to Kubernetes outside Azure AKS","path":"/v1.5-beta/installation/outside-azure-aks/"},{"title":"Updating akv2k8s CRDs","sidebarTitle":"","description":"How to update akv2k8s Custom Resource Definitions (CRDs)","path":"/v1.5-beta/installation/crd/"},{"title":"Installation without Helm","sidebarTitle":"","description":"How to setup Azure Key Vault to Kubernetes","path":"/v1.5-beta/installation/without-helm/"},{"title":"Upgrade","sidebarTitle":"","description":"How to upgrade Azure Key Vault to Kubernetes","path":"/v1.5-beta/installation/upgrade/"},{"title":"Add Exception for aad-pod-identity","sidebarTitle":"","description":"Learn what needs to be done to run successfully with aad-pod-identity","path":"/v1.5-beta/installation/with-aad-pod-identity/"},{"title":"Installing with Azure AD Workload Identity","sidebarTitle":"","description":"Learn what needs to be done to run successfully with azure ad workload identity","path":"/v1.5-beta/installation/with-azure-workload-identity/"}]},{"title":"Tutorials","pages":[{"title":"Tutorials","sidebarTitle":"","description":"A quick introduction to the tutorials","path":"/v1.5-beta/tutorials/"},{"title":"Prerequisites","sidebarTitle":"","description":"A quick overview of the prerequisites needed to complete the tutorials","path":"/v1.5-beta/tutorials/prerequisites/"},{"title":"Sync Secret","sidebarTitle":"","description":"Sync a secret from Azure Key Vault into a Kubernetes Secret","path":"/v1.5-beta/tutorials/sync/1-secret/"},{"title":"Sync Certificate","sidebarTitle":"","description":"Sync a certificate from Azure Key Vault into a Kubernetes Secret.","path":"/v1.5-beta/tutorials/sync/2-certificate/"},{"title":"Sync Signing Key","sidebarTitle":"","description":"Sync signing key from Azure Key Vault into a Kubernetes Secret","path":"/v1.5-beta/tutorials/sync/3-signing-key/"},{"title":"Sync Multi Key Value Secret","sidebarTitle":"","description":"Sync a multi-key-value secret from Azure Key Vault into a Kubernetes Secret","path":"/v1.5-beta/tutorials/sync/4-multi-key-value-secret/"},{"title":"Sync Multiple AKVS to One Secret","sidebarTitle":"","description":"Sync multiple AzureKeyVaultSecrets to a single Kubernetes Secret","path":"/v1.5-beta/tutorials/sync/5-multi-akvs-to-one-secret/"},{"title":"Sync Secret to ConfigMap","sidebarTitle":"","description":"Sync a secret from Azure Key Vault into a Kubernetes ConfigMap","path":"/v1.5-beta/tutorials/sync/6-secret-to-configmap/"},{"title":"Sync with Namespace Isolation of Controller","sidebarTitle":"","description":"Isolate Akv2k8s Controller to a specific namespace.","path":"/v1.5-beta/tutorials/sync/7-namespace-isolation-of-controller/"},{"title":"Sync Objects Based on Labels","sidebarTitle":"","description":"How to sync objects based on label selectors","path":"/v1.5-beta/tutorials/sync/8-label-filtered-syncing/"},{"title":"Sync PFX Certificate Stored as Secret","sidebarTitle":"","description":"Sync a certificate stored as secret from Azure Key Vault into a kubernetes.io/tls Kubernetes secret.","path":"/v1.5-beta/tutorials/sync/9-certificate-as-AKV-secret/"},{"title":"Inject Secret","sidebarTitle":"","description":"Inject an Azure Key Vault secret directly into a container application","path":"/v1.5-beta/tutorials/env-injection/1-secret/"},{"title":"Inject Certificate","sidebarTitle":"","description":"Inject an Azure Key Vault certificate key pair directly into a container application","path":"/v1.5-beta/tutorials/env-injection/2-certificate/"},{"title":"Inject Signing Key","sidebarTitle":"","description":"Inject a signing key from Azure Key Vault as environment variable into an application","path":"/v1.5-beta/tutorials/env-injection/3-signing-key/"},{"title":"Inject PFX Certificate","sidebarTitle":"","description":"Inject a PFX certificate from Azure Key Vault as environment variables into an application","path":"/v1.5-beta/tutorials/env-injection/5-pfx-certificate/"}]},{"title":"Security","pages":[{"title":"Authentication with Azure Key Vault","sidebarTitle":"","description":"Learn about the different options for authenticating with Azure Key Vault.","path":"/v1.5-beta/security/authentication/"},{"title":"Authorization","sidebarTitle":"","description":"Learn how to set the proper access rights in Azure Key Vault","path":"/v1.5-beta/security/authorization/"},{"title":"Enable Environment Injecton","sidebarTitle":"","description":"Learn how to enable environment injection per Kubernetes namespace","path":"/v1.5-beta/security/enable-env-injection/"}]},{"title":"Monitoring","pages":[{"title":"Logs","sidebarTitle":"","description":"Akv2k8s logs","path":"/v1.5-beta/monitoring/logs/"},{"title":"Metrics","sidebarTitle":"","description":"Akv2k8s metrics","path":"/v1.5-beta/monitoring/metrics/"}]},{"title":"Troubleshooting","pages":[{"title":"Get the akv2k8s Controller Log","sidebarTitle":"","description":"How to access the Controller log and specify log level","path":"/v1.5-beta/troubleshooting/controller-log/"},{"title":"Set env-injector log-level","sidebarTitle":"","description":"How to set the log-level for the env-injector","path":"/v1.5-beta/troubleshooting/env-injector-log-level/"},{"title":"Known Issues","sidebarTitle":"","description":"A list of known issues and available solutions or workarounds","path":"/v1.5-beta/troubleshooting/known-issues/"}]},{"title":"Reference","pages":[{"title":"AzureKeyVaultSecret","sidebarTitle":"","description":"Reference of AzureKeyVaultSecret custom resource definition","path":"/v1.5-beta/reference/azure-key-vault-secret/"}]}],"githubUrl":"https://github.com/sparebankenvest/akv2k8s-website/tree/v1.5.0-beta/source/content/installation/requirements.md","spectrumUrl":"","twitterHandle":"","versions":["1.5-beta","1.3","1.2","1.1","1.0"],"defaultVersion":"1.4","baseUrl":"https://akv2k8s.io"}},"staticQueryHashes":["1511030359","2468095761","2468095761","426988268","426988268"]}